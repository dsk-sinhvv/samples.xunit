version: 2.1

jobs:
  restore:
    docker:
      - image: ubuntu:22.04
    working_directory: ~/app
    steps:
      - checkout

      - run:
          name: Install prerequisites
          command: |
            apt-get update
            apt-get install -y wget apt-transport-https software-properties-common

      - run:
          name: Install Microsoft package repository
          command: |
            wget https://packages.microsoft.com/config/ubuntu/22.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb
            dpkg -i packages-microsoft-prod.deb
            rm packages-microsoft-prod.deb
            apt-get update

      - run:
          name: Install .NET SDK 9.0.100
          command: |
            apt-get install -y dotnet-sdk-9.0

      - run:
          name: Verify dotnet version
          command: dotnet --info

      - run:
          name: Restore NuGet packages
          command: dotnet restore

workflows:
  version: 2
  build:
    jobs:
      - restore
